


<!DOCTYPE html>
<html lang="ko">
<head>

	<meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    
    <link rel="stylesheet" type="text/css" href="http://cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.css"/>
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick-theme.min.css"/>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" integrity="sha512-1ycn6IcaQQ40/MKBW2W4Rhis/DbILU74C1vSrLJxCq57o941Ym01SwNsOMqvEBFlcgUa6xLiPY/NS5R+E6ztJQ==" crossorigin="anonymous" referrerpolicy="no-referrer" />
	<link rel="stylesheet" href="/report/css/style.css?var=1"  type="text/css">
	<link rel="stylesheet" href="./css/style.css?var=1"  type="text/css">
	<!-- <link rel="stylesheet" href="../css/style.css?var=1"  type="text/css"> --> 
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/js/all.min.js" integrity="sha512-Tn2m0TIpgVyTzzvmxLNuqbSJH3JP8jm+Cy3hvHrW7ndTDcJ1w5mBiksqDBb8GpE2ksktFvDB/ykZ0mDpsZj20w==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.4/jquery.min.js" integrity="sha512-pumBsjNRGGqkPzKHndZMaAG+bir374sORyzM3uulLV14lN5LyykqNk8eEeUlUkB3U0M4FApyaHraT65ihJhDpQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script type="text/javascript" src="http://cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.min.js"></script>  
    
    
    

</head>
<body>  

    <header>
           <div class="top-banner">
               <div class="top-banner-logo"> 
                   <a href="/report"><img src="/report/images/banner-logo.png" alt=""/></a>
               </div>
            
            <div class="top-banner-middle">
                <a href=""><span>Flowers Shop</span></a>
                <a href=""><span>About</span></a>
                <a href=""><span>Classes</span></a>
                <a href=""><span>Scents</span></a>
                <a href=""><span>Private</span></a>
            </div>

            <div class="search">
                <!-- <p1>login</p1>
                <p2>Register</p2> -->
                <input type="text" value="Search">
                <i class=xi-search></i>
            </div>
        </div>
    </header>
    
    <div class="menu">
       <div class="board-box"> 
            <a href="/report" class="board home"></a>
        </div>
        <div class="dropDown">
           <a href="/report/board/list" class="board free"></a>
           <div class="none-dropDown">
               <a href="#" class="board Notice"></a> 
               <a href="#" class="board free2"></a>
           </div>
       </div>
    </div>
	
		<div class="detail">
	        <div class="detail-head">
	            <div class="top">
	                <div class="num">532</div>
	                <div class="title">레포트파일 테스트</div>
	                <div class="writer">id1</div>
	                <div class="date">2023-03-15</div>
	                <div class="count">4</div>
	            </div>   
	        </div> 
	        <div class="detail-writer">
				<textarea id="content" placeholder="Enter content" name="content" rows="10" readonly>1</textarea>
	        </div>
	        
	        <div class="mb-3">
			    <p class="">files</p>
			    
			  </div>
	        
	        <div class="detail-btn">
	            <a href="list?pageNum=1&amount=10&category=1&keyword=" class="on">목록</a>
	            <a href="modify?bno=532&pageNum=1&amount=10&category=1&keyword=" >수정</a>
	            <a href="remove?bno=532&pageNum=1&amount=10&category=1&keyword=" class="remove">삭제</a>
	        </div>
	    </div>
      	<div class="replyArea"  id="#replyArea">
            <p for="writer" class=""><i class="fas fa-comment-dots"></i> replies</p>
            <div class="commentArea">
                 <textarea class="" id="commentArea" placeholder="Enter commets" rows="3"></textarea>	
                 <button type="button" class="">댓글 작성</button>  
            </div>
        </div>         
            <ul class="replies">
                <li class="">
                    <div class="">
                      <p>댓글이 없습니다</p> 
                    </div>
                </li>
            </ul> 
            


   <footer>
        <div class="footer-area">
            <p1>사이트 – 사이트 관리자: The Level Group S.r.l – Copyright © Dolce & Gabbana S.r.l. 2022 – All rights reserved – 콘텐츠 복제는 엄격히 금지됩니다.</p1>
            <p2><br>The Level Group S.r.l. (한국 지사), 주소: 서울특별시 강남구 영동대로 517, (삼성동, 아셈타워) 37층</p2>
            <p3><br>한국 지사 대표: Cristian Musardo - 사업자등록번호: 572-84-00029</p3>
            <p4><br>우편 주문 판매 보고서 번호: 2021-Seoul Gangnam-04007 - 사업자정보확인 - 호스팅 서비스: SalesForce</p4>
            <p5><br>고객 서비스 전화번호: 00 308 640139 | 이메일: supportkr@dolcegabbana.com</p5>
        </div>
    </footer>

<script>
	$(".remove").click(function(){
		return confirm("정말 삭제 하시겠습니까?");
	});

	let contextPath ='/report';
	let replyPath = contextPath + "/reply"
	let bno = '532';
	let writer ='';
	
	showList();
	function showList(){
	$.ajax({
		url : replyPath,
		data : {bno:bno},
		success : list
	})
  }
	// 댓글조회 목록  
    function list(replies){
    // let jsonStr='[{"rno":2,"content":"댓글댓글","regDate":"2023-03-13 12:57:46","writer":"id1","bno":513},{"rno":4,"content":"댓글댓글","regDate":"2023-03-13 12:57:51","writer":"id1","bno":513},{"rno":5,"content":"댓글댓글","regDate":"2023-03-13 12:57:52","writer":"id1","bno":513}]';
    // let replies = JSON.parse(jsonStr);
    // console.log(replies)
    let str = "";
    if(!replies.length){
    	str = ` <li class="list-unstyled px-4">
            		<div class="mb-4 small text-center">
            			<p>댓글이 없습니다</p> 
          			</div>
       			 </li>`;
        $(".replies").html(str);
        return;
    }
    
    for(let i in replies){
        let r = replies[i];
        console.log(r.rno, r.content, r.regDate, r.writer, r.bno);
        let isMine = writer === r.writer
		// let isMine = true
        str += `
                    <li class="list-unstyled px-4" data-rno="${r.rno}">
                      <div class="row"> 
                            <a class="text-muted small mb-3 col text-decoration-none" href="">
                                <span class="fs-6 fw-bold">${r.writer}</span>
                                <span class="mx-5">${r.regDate}</span>
                            </a>
                			<div class="col text-end ">`;
                	str +=	isMine ? '<a href="" class="text-muted"><i class="fas fa-trash"></i></a>' : ''
                 	str +=	`</div>
                        </div>
                      	<div class="mb-4 small">
                        <p>${r.content}</p> 
                      </div>
                    </li>
        `;
    }
    $(".replies").html(str);
  }
	
 // 댓글 작성 
    $("#commentArea").next().click(function(){
        let content = $("#commentArea").val()
        if(!writer){
        	alert("로그인 후 작성하세요");
        	location.href = contextPath + "/member/login?href=" + encodeURIComponent(location.pathname + location.search + '#replyArea');
        	return;
        }
        else if(!content){
        	alert("댓글 내용을 입력하세요")
        	return;
        }
        $.ajax({
        	url : replyPath,
        	data : {bno:bno, content:content, writer:writer},
        	method : "POST",
        	success : function(data){
        		alert("댓글이 성공적으로 작성되었습니다");
        		$("#commentArea").val("");
        		showList();
        	}
        })
    })

    // 댓글 삭제
    $(".replies").on("click", "li a.text-muted", function(){
        event.preventDefault();
        if (!confirm("댓글을 삭제하시겠습니까?")){
        	return false;
        }        
        let rno = $(this).closest("li").data("rno");
        $.ajax({
        	url : replyPath + "?rno=" + rno,
        	method : "DELETE",
        	success : function(data){
        		if(data == 1){
	        		alert("댓글이 성공적으로 삭제되었습니다");
	        		showList();
        		}
        	}
        })
    })
</script>

</body>
</html>